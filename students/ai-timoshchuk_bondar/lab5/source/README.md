# **Отчет по лабораторной работе №5: Модель латентных факторов (LFM)**

## **Описание модели латентных факторов**

Модель латентных факторов (Latent Factor Model, LFM) — один из базовых подходов для рекомендательных систем. Суть модели заключается в аппроксимации матрицы рейтингов пользователей и объектов через факторизацию:

$$
\hat{r}_{ui} = \mu + b_u + b_i + p_u^T q_i
$$

Где:

* $\hat{r}_{ui}$ — предсказанный рейтинг пользователя $u$ для объекта $i$;
* $\mu$ — глобальное среднее значение рейтингов;
* $b_u, b_i$ — смещения пользователя и объекта;
* $p_u, q_i$ — латентные векторы пользователя и объекта соответственно.

Обучение происходит с помощью стохастического градиентного спуска (SGD) с регуляризацией.

## **Описание датасета**

В качестве данных использован классический датасет **MovieLens 100K**, содержащий анонимные рейтинги фильмов, выставленные пользователями.

### **Краткое описание:**

* Количество пользователей: 943
* Количество фильмов: 1682
* Количество рейтингов: 100 000
* Диапазон рейтингов: от 1 до 5
* Задача: прогнозирование рейтингов пользователей для фильмов.

Данные были случайным образом разделены на обучающую (75%) и тестовую (25%) выборки.

## **Результаты экспериментов**

### **Собственная реализация (NumPy LatentFactorModel)**

* Количество латентных факторов: 50
* Скорость обучения: 0.01
* Регуляризация: 0.02
* Количество эпох: 30
* Время обучения: **4.57 секунд**
* RMSE на тестовой выборке: **0.9267**
* Среднее время одного предсказания: **21.1 мкс**

### **Эталонная реализация (Surprise SVD)**

* Количество латентных факторов: 50
* Скорость обучения: 0.01
* Регуляризация: 0.02
* Количество эпох: 30
* Время обучения: **1.61 секунд**
* RMSE на тестовой выборке: **0.9165**
* Среднее время одного предсказания: **5.3 мкс**

## **Сравнение с эталонной реализацией**

| Модель       | Время обучения (с) | Среднее время предсказания (мкс) | RMSE   |
| ------------ | ------------------ | -------------------------------- | ------ |
| NumPy LFM    | 40.57               | 21.1                             | 0.9567 |
| Surprise SVD | 10.61               | 5.3                              | 0.9165 |

## **Выводы**

* Собственная реализация модели латентных факторов успешно обучается и демонстрирует качество, сопоставимое с эталонной библиотечной реализацией.
* По точности предсказаний (RMSE) библиотечный алгоритм `Surprise SVD` показывает немного лучший результат.
* Время обучения и время предсказания у библиотечной реализации значительно ниже, что объясняется оптимизациями и использованием более эффективных численных методов.
* Собственная реализация полезна для понимания принципов работы модели, однако для реальных задач рекомендуется использовать готовые оптимизированные решения.
