# Градиентный бустинг

## Описание алгоритма градиентного бустинга

Градиентный бустинг - это алгоритм машинного обучения, который построен на принципе последовательного обучения слабых моделей (обычно деревьев решений) для минимизации ошибки предсказания. Основные этапы алгоритма:

1. Инициализация модели с начальным предсказанием (обычно среднее значение целевой переменной)
2. Для каждой итерации:
   - Вычисление градиентов (остатков) между реальными и предсказанными значениями
   - Обучение нового дерева решений на этих остатках
   - Добавление предсказаний нового дерева с учетом скорости обучения
3. Финальное предсказание формируется как сумма всех предсказаний базовых моделей

## Описание датасета

В качестве исходных данных использован датасет недвижимости США (realtor-data.zip.csv), содержащий следующие признаки:
- **Числовые признаки:**
  - Площадь, количество спален (bed), количество ванных (bath), год постройки, площадь участка, цена и др.
- **Категориальные признаки:**
  - Штат, город, тип недвижимости и др.
- **Целевая переменная:**
  - `price` — цена объекта недвижимости (в долларах США)


## Результаты экспериментов

- **Качество прогнозирования:** 
Результаты кросс-валидации для собственной реализации:\
RMSE: $377,462 (+/- $138,792)\
R²: 0.4056 (+/- 0.2302)\
MAE: $223,236 (+/- $102,624)\
Результаты кросс-валидации для реализации scikit-learn:\
RMSE: $377,854 (+/- $138,958)\
R²: 0.4041 (+/- 0.2344)\
MAE: $223,653 (+/- $102,659)
- **Скорость работы:**
  - scikit-learn обучается быстрее, чем собственная реализация
- **Кросс-валидация:**
  - Метрики по фолдам стабильны, разброс невелик
- **Важность признаков:**
  - Наиболее важные: площадь, количество спален, количество ванных, год постройки, местоположение
  - Для 90% кумулятивной важности достаточно 7–10 признаков

## Выводы

1. **Качество прогнозирования:**
   - Обе реализации градиентного бустинга (собственная и scikit-learn) показали сопоставимое качество прогнозирования на тестовой выборке.
   - R² для обеих моделей находится в диапазоне **0.60–0.62**, что говорит о хорошем объяснении вариации цен на недвижимость.
   - RMSE и MAE для обеих моделей отличаются незначительно, что подтверждает корректность собственной реализации.
2. **Скорость работы:**
   - Усредняя результаты различных запусков, реализация scikit-learn обучается быстрее, чем собственная реализация, что объясняется оптимизациями на уровне библиотеки.
3. **Кросс-валидация:**
   - Кросс-валидация показала стабильные результаты для обеих моделей: разброс метрик по фолдам невелик.
   - Средние значения RMSE и MAE по кросс-валидации практически совпадают для обеих реализаций.
   - R² по кросс-валидации также стабилен и подтверждает качество моделей.
4. **Анализ важности признаков:**
   - Наиболее важными признаками для прогнозирования цены недвижимости оказались: площадь, количество спален, количество ванных комнат, год постройки, а также местоположение (штат/город).
   - Для достижения 90% кумулятивной важности достаточно 7–10 признаков из всего набора.