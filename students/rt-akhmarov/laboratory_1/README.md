# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1. –ê–Ω—Å–∞–º–±–ª–∏ –º–æ–¥–µ–ª–µ–π

## üìö –¢–µ–æ—Ä–∏—è

**–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å (Random Forest)** ‚Äî —ç—Ç–æ –∞–Ω—Å–∞–º–±–ª–µ–≤—ã–π –º–µ—Ç–æ–¥ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤—å–µ–≤ —Ä–µ—à–µ–Ω–∏–π –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π. –û–Ω –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∫ –¥–ª—è –∑–∞–¥–∞—á –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–∞–∫ –∏ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –ú–µ—Ç–æ–¥ —Å–æ—á–µ—Ç–∞–µ—Ç **–±—ç–≥–≥–∏–Ω–≥ (bootstrap aggregating)** –∏ **—Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

---

### üß† –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **Bootstrap-–≤—ã–±–æ—Ä–∫–∞**:
   –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞ $T_k$ –∏–∑ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤—å–µ–≤ $n$ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ $D_k$ —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º:

   $$
   D_k = \{(x_i, y_i)\}_{i=1}^m,\quad x_i, y_i \sim D
   $$

2. **–°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**:
   –ü—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–∞–∑–±–∏–µ–Ω–∏–∏ –≤ —É–∑–ª–µ –¥–µ—Ä–µ–≤–∞ —Å–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ $F_k \subseteq F$, –≥–¥–µ:

   $$
   |F_k| = \sqrt{p} \quad \text{(–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏)}
   $$

   –≥–¥–µ $p$ ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

3. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞**:
   –ö–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ –æ–±—É—á–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –Ω–∞ —Å–≤–æ–µ–π –≤—ã–±–æ—Ä–∫–µ –∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–∞–∑–±–∏–µ–Ω–∏–∏.

4. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π**:
   - –î–ª—è **–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º**:

     $$
     \hat{y} = \text{mode}\left( T_1(x), T_2(x), \dots, T_n(x) \right)
     $$

   - –î–ª—è **—Ä–µ–≥—Ä–µ—Å—Å–∏–∏** ‚Äî —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ:

     $$
     \hat{y} = \frac{1}{n} \sum_{k=1}^n T_k(x)
     $$

---

üìé *–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å —Å–Ω–∏–∂–∞–µ—Ç –¥–∏—Å–ø–µ—Ä—Å–∏—é –º–æ–¥–µ–ª–∏ –∑–∞ —Å—á—ë—Ç –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Å–º–µ—â–µ–Ω–∏—è.*

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ö–ª–∞—Å—Å—Ñ–∏–∫–∞—Ç–æ—Ä                    | –ö–æ–ª-–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ | ‚úÖ Accuracy | üéØ Precision | üì¢ Recall |
|--------------------------------|------------------|-------------|---------------|------------|
| MyRandomForestClassifier       | 41               | 0.9884      | 0.9891        | 0.9826     |
| Sklearn RandomForestClassifier | 101              | 0.9884      | 0.9915        | 0.9826     |

## üìâ –ì—Ä–∞—Ñ–∏–∫–∏ –º–µ—Ç—Ä–∏–∫

### üîç Accuracy, Precision, Recall vs. –ö–æ–ª-–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Random Forest

![Accuracy Plot](./img/my_metrics.png)

### üîç Accuracy, Precision, Recall vs. –ö–æ–ª-–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤ –¥–ª—è sklearn —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Random Forest

![Accuracy Plot](./img/sk_metrics.png)


## ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚åõ –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è (Training Time)

![Training Time Plot](./img/train_time.png)

### ‚åõ –í—Ä–µ–º—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (Prediction Time)

![Prediction Time Plot](./img/pred_time.png)

---

