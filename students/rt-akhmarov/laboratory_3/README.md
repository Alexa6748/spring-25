# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3. –ù–∞–∏–≤–Ω—ã–π –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä

## üìò –¢–µ–æ—Ä–∏—è

–ù–∞–∏–≤–Ω—ã–π –±–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ **—Ç–µ–æ—Ä–µ–º—ã –ë–∞–π–µ—Å–∞** —Å –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –æ **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**. –ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞:

$$
P(C \mid X) = \frac{P(X \mid C) \cdot P(C)}{P(X)}
$$

–í –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

$$
P(C \mid X) \propto P(C) \cdot \prod_{i=1}^{n} P(x_i \mid C)
$$

–î–ª—è –º–æ–¥–µ–ª–∏ **Multinomial Naive Bayes** (—Ç–µ–∫—Å—Ç, bag-of-words):

$$
P(C \mid X) \propto P(C) \cdot \prod_{i=1}^{n} P(w_i \mid C)^{x_i}
$$

–ë–µ—Ä—ë–º –ª–æ–≥–∞—Ä–∏—Ñ–º, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è:

$$
\log P(C \mid X) = \log P(C) + \sum_{i=1}^{n} x_i \cdot \log P(w_i \mid C)
$$

---

## üìÇ –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞

### –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

üìÑ **1776 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º:

| –ö–ª–∞—Å—Å                    | –ö–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
|--------------------------|-------------------|
| sci.space                | 584               |
| comp.graphics            | 593               |
| soc.religion.christian  | 599               |

### –î–ª–∏–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ø–æ –∫–ª–∞—Å—Å–∞–º:

| –ö–ª–∞—Å—Å                   | –°—Ä–µ–¥–Ω—è—è | –ú–µ–¥–∏–∞–Ω–∞ | –ú–∏–Ω | –ú–∞–∫—Å |
|-------------------------|---------|---------|-----|------|
| sci.space               | 157.8   | 62.0    | 0   | 9109 |
| comp.graphics           | 202.3   | 82.0    | 0   | 6109 |
| soc.religion.christian | 262.8   | 157.0   | 0   | 2939 |

**–ü—Ä–∏–º–µ—Ä—ã:**

- üîΩ *–°–∞–º—ã–π –∫–æ—Ä–æ—Ç–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç (`sci.space`)*: `¬´...¬ª`
- üîº *–°–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç (`comp.graphics`)*:  
  `¬´COMMERCIAL SPACE NEWS/SPACE TECHNOLOGY INVESTOR NUMBER 22...¬ª`

### –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –ø–æ—Å–ª–µ `CountVectorizer`:

| –ö–ª–∞—Å—Å                   | –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ |
|-------------------------|-----------------|
| sci.space               | 10592           |
| comp.graphics           | 13273           |
| soc.religion.christian | 11521           |

üß† **–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –≤–æ –≤—Å–µ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö:** **25381**

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (–∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è, 5 —Ñ–æ–ª–¥–æ–≤, macro average)

### –ú–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

| fold | accuracy | precision | recall | f1    |
|------|----------|-----------|--------|-------|
| 0    | 0.8933   | 0.9043    | 0.8930 | 0.8933 |
| 1    | 0.8986   | 0.9017    | 0.8985 | 0.8982 |
| 2    | 0.9183   | 0.9215    | 0.9181 | 0.9182 |
| 3    | 0.9127   | 0.9164    | 0.9121 | 0.9121 |
| 4    | 0.9099   | 0.9139    | 0.9094 | 0.9095 |
| **mean** | **0.9065** | **0.9116** | **0.9062** | **0.9063** |

### –≠—Ç–∞–ª–æ–Ω (sklearn):

| fold | accuracy | precision | recall | f1    |
|------|----------|-----------|--------|-------|
| 0    | 0.8933   | 0.9043    | 0.8930 | 0.8933 |
| 1    | 0.8986   | 0.9017    | 0.8985 | 0.8982 |
| 2    | 0.9183   | 0.9215    | 0.9181 | 0.9182 |
| 3    | 0.9127   | 0.9164    | 0.9121 | 0.9121 |
| 4    | 0.9099   | 0.9139    | 0.9094 | 0.9095 |
| **mean** | **0.9065** | **0.9116** | **0.9062** | **0.9063** |

---

## ‚è± –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –†–µ–∞–ª–∏–∑–∞—Ü–∏—è       | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è                          |
|------------------|--------------------------------------------|
| –ú–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è   | 696 ms ¬± 1.77 ms per loop (7 runs)         |
| –≠—Ç–∞–ª–æ–Ω (sklearn) | 707 ms ¬± 5.66 ms per loop (7 runs)         |
